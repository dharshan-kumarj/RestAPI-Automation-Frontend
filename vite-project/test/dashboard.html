<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Profile</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script>
      // Function to get a cookie value by name
      function getCookie(name) {
        let cookieArr = document.cookie.split(";");
        for (let i = 0; i < cookieArr.length; i++) {
          let cookiePair = cookieArr[i].split("=");
          if (name == cookiePair[0].trim()) {
            return decodeURIComponent(cookiePair[1]);
          }
        }
        return null;
      }

      // Function to send the POST request and display the result
      async function fetchProfile() {
        const token = getCookie("token");
        if (!token) {
          document.getElementById("result").innerHTML =
            "Token not found in cookies";
          return;
        }

        const response = await fetch("http://localhost:8000/profile", {
          method: "POST",
          headers: {
            accept: "application/json",
            token: token,
          },
          body: "",
        });

        const result = await response.json();
        document.getElementById("result").innerHTML = JSON.stringify(
          result,
          null,
          2
        );
      }

      // Fetch profile on page load
      window.onload = fetchProfile;
    </script>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="text-center">User Profile</h1>
      <div id="result" class="mt-4"></div>
    </div>
  </body>
</html>
